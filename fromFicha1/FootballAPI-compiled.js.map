{"version":3,"sources":["FootballAPI.js"],"names":[],"mappings":"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","file":"FootballAPI-compiled.js","sourcesContent":["'use strict';\r\n\r\nconst http = require(\"http\");\r\nconst request = require(\"request\");\r\nconst fs = require(\"fs\");\r\n\r\n/**\r\n * Module to access FootballApi a fetch data\r\n * @returns {{getLeagues:getLeagues, getFixtures:getFixtures, getPlayers:getPlayers, getTeams:getTeams, getLeagueTable:getLeagueTable,\r\n*               getFromApi: getFromApi, getImage: getImage, options: {host: string, path: string}}}\r\n * @constructor\r\n */\r\nfunction FootballAPI() {\r\n\r\n    // privates\r\n    const API_KEY = 'e654bec89e924d1c8debc2031e16cb6c';\r\n    const options = {\r\n        host: 'api.football-data.org',\r\n        //path: '/alpha/soccerseasons'\r\n        path: '/v1/soccerseasons'\r\n    };\r\n    const FIXTURE_OPTIONS = {\r\n        host: 'api.football-data.org',\r\n        //path: '/alpha/soccerseasons/$id/fixtures'\r\n        path: '/v1/soccerseasons/$id/fixtures'\r\n    };\r\n\r\n    /**\r\n     * Fetches leagues from API\r\n     *\r\n     * @param context execution context\r\n     * @param leagues league list\r\n     * @param callback function to execute when getLeagues is completed\r\n     */\r\n    function getLeagues(context,leagues,callback){\r\n        console.log(\"GetLeagues\");\r\n        var body = \"\";\r\n        var request = new http.request(options, processLeagues);\r\n        request.setHeader(\"X-Auth-Token\", API_KEY);\r\n        request.end();\r\n\r\n        function processLeagues(res){\r\n            res.on(\"data\",function(chunk){\r\n                body += chunk;\r\n            });\r\n\r\n            res.on(\"end\",function(){\r\n                var result = [];\r\n                if (leagues!=undefined) {\r\n                    leagues.forEach(leagueName=> {\r\n                        result.push(JSON.parse(body).filter(function (league) {\r\n                            return league.caption === leagueName || league.league === leagueName;\r\n                        })[0]);\r\n                    });\r\n                } else {\r\n                    result = JSON.parse(body);\r\n                }\r\n                //Store leagues in context\r\n                context.addData(\"leagues\",result);\r\n                callback(context,result);\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fetches fixtures from API\r\n     *\r\n     * @param context execution context\r\n     * @param league for fixtures\r\n     * @param callback function to execute when getFixtures ends\r\n     */\r\n    function getFixtures(context,league, callback){\r\n        console.log(\"getFixtures\");\r\n        var body = \"\";\r\n        console.log(league);\r\n        var request = new http.request(league._links.fixtures.href, processFixtures);\r\n        request.setHeader(\"X-Auth-Token\", API_KEY);\r\n        request.end();\r\n\r\n        function processFixtures(res){\r\n            res.on(\"data\",function(chunk){\r\n                body += chunk;\r\n            });\r\n\r\n            res.on(\"end\",function(){\r\n                var result = JSON.parse(body);\r\n                result.leagueName = league.caption;\r\n                result.leagueCode = league.league;\r\n                context.addData(\"fixtures\",result);\r\n                callback(context,result);\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fetches fixtures from API using League ID\r\n     *\r\n     * @param context execution context\r\n     * @param leagueId for fixtures\r\n     * @param callback function to execute when getFixtures ends\r\n     */\r\n    function getFixturesByLeagueId(context,leagueId, callback){\r\n        console.log(\"getFixtures\");\r\n        var body = \"\";\r\n        console.log(leagueId[0]);\r\n        var fixtureOptions = FIXTURE_OPTIONS;\r\n        fixtureOptions.path=fixtureOptions.path.replace(\"$id\",leagueId[0]);\r\n        var request = new http.request(fixtureOptions, processFixtures);\r\n        request.setHeader(\"X-Auth-Token\", API_KEY);\r\n        request.end();\r\n\r\n        function processFixtures(res){\r\n            res.on(\"data\",function(chunk){\r\n                body += chunk;\r\n            });\r\n\r\n            res.on(\"end\",function(){\r\n                var result = JSON.parse(body);\r\n                //result.leagueName = league.caption;\r\n                //result.leagueCode = league.league;\r\n                context.addData(\"fixtures\",result);\r\n                callback(context,result);\r\n            })\r\n        }\r\n    }\r\n    /**\r\n     * Fetches all teams for a league\r\n     *\r\n     * @param context execution context\r\n     * @param league refereing league for teams\r\n     * @param callback function to be executed when getTeams ends\r\n     */\r\n    function getTeams(context,league, callback){\r\n        console.log(\"getTeams\");\r\n        var body = \"\";\r\n\r\n        var request = new http.request(league._links.teams.href, processTeams);\r\n        request.setHeader(\"X-Auth-Token\", API_KEY);\r\n        request.end();\r\n\r\n        function processTeams(res){\r\n            res.on(\"data\",function(chunk){\r\n                body += chunk;\r\n            });\r\n\r\n            res.on(\"end\",function(){\r\n                var result = JSON.parse(body);\r\n                result.leagueName = league.caption;\r\n                result.leagueCode = league.league;\r\n                result.teams.forEach(team=>{\r\n                    team.leagueCode=league.league;\r\n                    team.leagueName=league.caption;\r\n\r\n                    team.image=team.name+team.crestUrl.substr(team.crestUrl.length-4,4);\r\n                });\r\n                context.addData(\"teams\",result);\r\n                callback(context,result);\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fetches all players of a team\r\n     *\r\n     * @param context execution context\r\n     * @param team refereing team\r\n     * @param callback function to be executed on end\r\n     */\r\n    function getPlayers(context,team, callback, leagueCode, leagueName){\r\n        console.log(\"getPlayers\");\r\n        var body = \"\";\r\n\r\n        var request = new http.request(team._links.players.href, processPlayers);\r\n        request.setHeader(\"X-Auth-Token\", API_KEY);\r\n        request.end();\r\n\r\n        function processPlayers(res){\r\n            res.on(\"data\",function(chunk){\r\n                body += chunk;\r\n            });\r\n\r\n            res.on(\"end\",function(){\r\n                var result = JSON.parse(body);\r\n                result.teamName = team.name;\r\n                result.teamCode = team.code;\r\n\r\n                result.leagueCode=leagueCode;\r\n                result.leagueName=leagueName;\r\n\r\n                context.addData(\"players\",result);\r\n                callback(context,result);\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fetches league table from API\r\n     *\r\n     * @param context execution context\r\n     * @param league\r\n     * @param callback function to be executed when request ends\r\n     */\r\n    function getLeagueTable(context,league, callback){\r\n        console.log(\"getLeagueTable\");\r\n        var body = \"\";\r\n\r\n        var request = new http.request(league._links.leagueTable.href, processLeagueTable);\r\n        request.setHeader(\"X-Auth-Token\", API_KEY);\r\n        request.end();\r\n\r\n        function processLeagueTable(res){\r\n            res.on(\"data\",function(chunk){\r\n                body += chunk;\r\n            });\r\n\r\n            res.on(\"end\",function(){\r\n                var result = JSON.parse(body);\r\n                result.leagueName = league.caption;\r\n                result.leagueCode = league.league;\r\n                context.addData(\"leagueTable\",result);\r\n                callback(context,result);\r\n            })\r\n        }\r\n    }\r\n    /**\r\n     * Makes a request to API and sends response trough callback\r\n     *\r\n     * @param icontext object context... has all info!\r\n     * @param id to identify a resource type\r\n     * @param link resource to fetch\r\n     * @param callbackToCaller sends responso to caller\r\n     */\r\n    function getFromApi(icontext,id,link,callbackToCaller){\r\n        var callerCallback = callbackToCaller;\r\n        var identifier = id;\r\n        var context = icontext;\r\n\r\n        /**\r\n         * when server responds this is where that response is handeled\r\n         * @param response\r\n         */\r\n        function httpResponseCallback(response) {\r\n            var httpContent;\r\n\r\n            //another chunk of data has been recieved, so append it to `httpContent`\r\n            response.on('data', function (chunk) {\r\n                if (httpContent === undefined) httpContent = chunk;\r\n                else httpContent += chunk;\r\n            });\r\n\r\n            //Response complete. Call callback function to handle data\r\n            response.on('end', function () {\r\n                console.log(\"Response.END\");\r\n                callerCallback(context,identifier, JSON.parse(httpContent));\r\n            });\r\n\r\n            //on error, logs an event\r\n            response.on('error',function(){\r\n                console.log(\"getFromApi Error in HTTP response\");\r\n                console.log(\"Resource asked:\"+link);\r\n            })\r\n        }\r\n        if (link!=undefined) {\r\n            console.log(\"getFromApi:\" + link);\r\n            var request = http.request(link, httpResponseCallback);\r\n            request.setHeader(\"X-Auth-Token\", API_KEY);\r\n            request.end();\r\n        } else {\r\n            console.log(\"link:\"+link);\r\n            console.log(\"something weird must have happened...:S\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fetches image form an URI a saves it to file system\r\n     * Location of file is created based on contex and id\r\n     * @param context execution context.\r\n     * @param id of resource (in case of team: team name, e.g.)\r\n     * @param link URI for image\r\n     * @param callback function\r\n     */\r\n    function getImage(context,id,link,callback){\r\n        request(link, {encoding: 'binary'}, function(error, response, body) {\r\n            callback(body);\r\n            //fs.writeFile(context.getOutput()+\"images\\\\\"+id+link.substr(link.length-4,4), body, 'binary', function (err) {\r\n            //    console.log(\"API getImage error:\"+link);\r\n            //    console.log(err);\r\n            //});\r\n        });\r\n    }\r\n\r\n    return{\r\n        getLeagues:getLeagues,\r\n        getFixtures:getFixtures,\r\n        getFixturesByLeagueId:getFixturesByLeagueId,\r\n        getPlayers:getPlayers,\r\n        getTeams:getTeams,\r\n        getLeagueTable:getLeagueTable,\r\n        getFromApi:getFromApi,\r\n        getImage:getImage,\r\n        options:options\r\n    }\r\n\r\n}\r\n\r\nmodule.exports = {\r\n    FootballAPI: FootballAPI\r\n};"]}